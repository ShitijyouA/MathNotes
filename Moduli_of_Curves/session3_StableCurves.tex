\documentclass[a4paper]{jsarticle}
\usepackage[]{../math_note, macros, enumitem}
\usepackage[all]{xy}

%% for hyperref {{{
\usepackage[dvipdfmx, colorlinks=true, linkcolor=black]{hyperref}
\usepackage{pxjahyper}
%% }}}

\newcommand{\dualsh}{\omega^{\circ}}
\newcommand{\dersh}{\Omega}
\newcommand{\dermod}{\Omega}

\begin{document}
\title{ゼミノート \#3 \\ Stable Curves}
\author{七条彰紀}
\maketitle

\cite{HaMo} 2.C,Dを中心にstable curveについて記述する．
以下で曲線は全て\textbf{arithmetic genusが$2$以上}であるものとする．
これは特異曲線を扱うためにarithmetic genusを用い，
自己同型群が有限であるために$\geq 2$とする．

\section{Motivation: To Get Modular Compactification of \tp{$\M_g$}{Mg}.}
    G.I.T.によって$\M_g$を得る方法では，
    Hilbert scheme $\modH_{2(g-1)n, g, N}$\footnote{$N=(2n-1)(g-1)-1$.}の開集合$K$を用いて
    $\M_g=K/PGL(N+1, \C)$
    として$\M_g$を得た．

    そこでcompactification of $\M_g$
    （ここでは$\M_g$を開集合として含むprojetive scheme over $\Z$）を得る方法として，
    $K$の$\modH_{2(g-1)n, g, N}$での閉包を取って$PGL_{N+1}(\C)$で割る，
    ということが思いつく．
    しかしこれではmoduli spaceが得られない．
    moduli spaceを得るためには，
    $K$を含む集合$\tilde{K}$の商$\tilde{K}/PGL_{N+1}(\C)$をとらなくてはならない．
    これらの包含関係は$K \subset \tilde{K} \subset \cl_{\modH}(K)$となる．

    $\bar{K}$でなく$\tilde{K}$，という制限が必要な理由は次のように説明される:
    次のような$(s:t) \in \proj_{\C}^1-\{(0:1), (1:0)\}=:B$で
    パラメトライズされるfamily of smooth curvesを考える．
    \[
        C_{(a,b)}: s^3y^2z=s^3 x^3-st^2axz-t^3bz^3
        \mwhere
        a,b \in \C, (s:t) \neq (0:1), (1:0)
    \]
    $j$-invariantを計算すると，
    これはfiberwise trivial family（session1A2A参照）になっている．
    また，この曲線族$C_{(a,b)}$は$a,b$の値を変えることで
    任意の楕円曲線を含むものに成る．
    今family :: $C_{(a,b)} \to B$があるから，
    coarse moduli spaceの定義より，morphism :: $\phi \colon B \to \barM_g$が存在する．
    今，$\barM_g$はprojective (over $\Z$)であるから，proper (\cite{HarAG} Thm II.4.9)．
    なので$B=\proj_{\C}^1-\{(0:1), (1:0)\} \to \barM_g$は
    $\bar{\phi}: \proj^1 \to \barM_g$へ拡張される
    \footnote
    {
        証明の概略:
        criterion of propernessを用いて
        $\Spec \shO_{\affine^1, \zeta} \to \barM_g$を
        $\Spec \shO_{\affine^1, t} \to \barM_g$に拡張し，
        これらが$\phi$と貼り合わせられることを射の一意性から述べる．
        \url{ https://math.stackexchange.com/questions/1540201 },
        \url{ http://lovelylittlelemmas.rjprojects.net/properness-and-completeness-of-curves/ }
        を参照のこと．
    }．
    そこで$\bar{\phi}$の$(s:t)=(1:0)$におけるfiberを考えると，
    明らかにこれはcuspidal curve :: $y^2z=x^3$である．
    これはrational curveであり，他のfiberと同型でない．
    他のfiberは全て同型であったから，
    このfamilyではjamp phenomenonが発生している．
    したがってmoduli spaceを得るためには，
    cuspidal curveに対応する点を$K$に（そして$\M_g$に）付け加えてはならない．
    この意味でcuspidal curveは楕円曲線の``bad degeneration"と呼べる．

    ではjump phenomenonが発生しないような``good degeneration"は何か，
    というと，これがstable curveである．
    DeligneとMumfordがstable curveを定義し，研究した．

    3A, 4A

\section{Definition.}
    \begin{Def}[Stable Curve]
        stable curve of genus $g$とは，
        以下を満たす曲線（reduced scheme of pure dimension $1$ of finite type over $\C$）である．
        \begin{enumerate}
            \item 完備 ($=$proper),
            \item 連結,
            \item （存在すれば）特異点は通常2重点(node)のみ
                   \footnote{ nodeとは，$xy=0$の原点とanalytically isomorphicである点． },
            \item 自己同型群が有限位数．
            \item arithmetic genusが$g$．
        \end{enumerate}
    \end{Def}
    \begin{Remark}
    Hurwitz's automorphisms theoremから，
    connected proper smooth curve of genus $g \geq 2$は
    全てstable curveである．
    \end{Remark}

    まったく同様にstable $n$-pointed curveも定義できる．
    \begin{Def}
        stable $n$-pointed curveとは，
        以下を満たす曲線$C$（reduced scheme of pure dimension $1$ of finite type over $\C$）と，
        $C$のなめらかな$n$点$p_1,\dots,p_n$の組$(C, p_1,\dots,p_n)$のことである．
        \begin{enumerate}
            \item 完備 (=proper),
            \item 連結,
            \item （存在すれば）特異点は通常2重点(node)のみ,
            \item 自己同型群が有限位数,
            \item arithmetic genusが$g$．
        \end{enumerate}
        ただし$(C, p_1,\dots,p_n)$の自己同型とは，
        $\sigma(p_i)=p_i$を満たすような自己同型$\sigma: C \to C$のことである．
    \end{Def}
    関連してsemi-stable (pointed) curveとunstable (pointed) curveの概念がある．
    これは「自己同型群が有限群」であるという条件をゆるめたもので，
    「自己同型群が簡約群(reductive group)」とする．
    reductive groupはG.I.T.の文脈で現れる概念である．

    自己同型に関する条件は以下のように言い換えることが出来る．
    \begin{Prop}\label{prop:finauto}
        stable curveの定義は，
        「自己同型群が有限位数．」を以下のように書き換えたものと同値:
        $E$を$C$のsmooth rational irreducible componentとする．
        この時，$E$と$E$以外の部分($=\cl_C(C-E)=:R$)の交点は$3$つ以上．
    \end{Prop}
    
    参考: \url{ https://math.stackexchange.com/questions/248722 },
    \cite{HarDef} Thm27.4.

    証明は3つの命題に分けられる．

    \begin{Claim}
        $C$ :: stable curve of genus $g \geq 2$とする．
        $\Aut(C)$の部分群$G$を，
        $C$のsingular pointを固定し，$C$の各irreducible componentを集合として保つ元が成すものとする．
        $G$が有限群であるならば$\Aut(C)$は有限群である．
    \end{Claim}
    \begin{proof}
        正規部分群の定義から，$G$は$\Aut(C)$の正規部分群である(TODO: 詳細に)．
        $\Aut(C)/G$は，$G$の定義から
        singular point同士，irreducible component同士を交換する群である．
        $C$はNoetherianだからirreducible componentは有限個しか無い．
        singular point全体も曲線の閉集合(\cite{HarAG} Cor II.8.16)であるから有限個．
        よって仮定から$G, \Aut(C)/G$は有限群なので$\Aut(C)$も有限群．
    \end{proof}

    \begin{Claim}
        genus formulaを考えると，
        stable curve of genus $g \geq 2$のirreducible componentの種類は以下の他は
        smooth rational curveのみである．
        \begin{enumerate}[label=(\arabic*)]
            \item curve at worst nordal of genus $g \geq 2$.
            \item curve of genus $1$ minus one point.
            \item nordal curve of genus $0$ minus one point.
        \end{enumerate}
        $C$をこのリストのいずれかとする．
        この時$\# \Aut(C) < \infty$.
    \end{Claim}
    \begin{proof}
        (1)についてはHurwitz's automorphism theoremとして知られている．
    \end{proof}

    \begin{proof}[(命題(\ref{prop:finauto})の証明)]
        $E$はsmooth proper curveであって
        $\proj^1$とbirational equivalentであるもの．
        なので$\proj^1$と同型である(\cite{HarAG} Thm6.9)．

        $r=\# (R \cap E)$とし，
        $\proj^1$の自己同型のうち互いに異なる$r$点を固定するものを考える．
        これは$PGL(2, \C)$の元のうち，
        対応する点を固有ベクトルにもつものである．
        このようなものは$r<3$の時無数に存在し，
        $r \geq 3$ならば有限個しか存在しない．
        
        $r<3$とする．
        $E \cap R$を固定する$E$の自己同型は，
        $\id[R]$と貼り合わせることで$C$全体の自己同型へ拡張できる．
        こうして$\proj^1$の互いに異なる$r$点を固定する自己同型から，
        $C$の自己同型が作れた．
        したがって$C$の自己同型は$r<3$の時，無数に存在する．

        $r \geq 3$であるとする．
        $C$のirreducible componentは$C$ :: Noetherianゆえに有限個であり，
        前の主張と上での議論から，
        各componentは有限個の自己同型しか持たない．
        $C$全体の自己同型は高々これら部分ごとの自己同型の貼り合わせであるから
        \footnote
        {
            部分ごとの自己同型の全ての組み合わせが貼り合わせられるわけではないので，
            $C$全体の自己同型の個数は，
            部分ごとの自己同型の個数の積($=\prod \#\Aut(C_i)$)よりも少ない．
        }，
        有限個しかない．
    \end{proof}

    semi-stableは「交点が$2$つ以上」と書き換えたものと同値である．

\section{Example}
    \begin{Example}
        次の$\affine^1$上のfamilyを考える．
        \[ C_t: y^2z=x(x-1)(x-t) \mwhere t \in \affine^1. \]
        $t \neq 0,1$の時，$C_t$は楕円曲線である．
        また，任意の$\C$上の楕円曲線はこのfamilyのいずれかのfiberと同型である．
        すなわち，fiberwise trivial familyではない．
        そして$t=0,1$の時$C_t$はstable curveとなっている．
        （plotするときは$y \mapsto iy$と線形変換したほうがnodeが見やすい．）
    \end{Example}

\section{\tp{$\Delta=\barM_g-\M_g$}{Delta=barMg-Mg}}
%    \begin{Thm}
%        coarse moduli space of stable curves (resp. stable $n$-pointed curves)
%        :: $\barM_g$ (resp. $\barM_{g,n}$)が存在し，
%        これはprojective varietyである．
%    \end{Thm}
%    さらに，
%    Nodeを$\delta$個以上もつstable curveに対応する点の集合は，
%    pure codimention $\delta$であることが知られている.
%    特にこのことから，stable curveは多くとも$3g-3$個のnodeしか持てないことが分かる．

    nodeを$\delta$個持つstable curveが成すlocusを考える．
    \begin{Claim}
        nodeを$\delta$個持つstable curveが成すlocusを
        $N_{\delta} \subset \bar{\modM}_g$とする．
        この時，
        \[ \dim N_{\delta}=3g-3-\delta \quad (\implies \codim N_{\delta}=\delta). \]
        また，$\cl_{\bar{\modM}_g}(N_{\delta})$は
        nodeを$\delta$個以上持つstable curveが成すlocusに一致する．
    \end{Claim}
    このことは\cite{HaMo} Thm3.150直後の段落でも触れられている．

    nodeを$1$個以上持つcurveのlocus :: $\Delta=\barM_g-\M_g$は，
    $\M_g$が$\barM_g$の開集合であるから，これはclosed in $\barM_g$．
    上の主張から，$\Delta$はnodeを丁度$1$つ持つcurveのlocusのclosureである．
    そこで$\Delta_0$と$\Delta_i \ (i=1,\dots,\lfloor g/2\rfloor)$を次のように定める．
    \begin{itemize}
        \item $\Delta_0=\cl_{\barM_g}(\{ [C] \in \barM_g \mid
                C \text{ :: irreducible curve with $1$ node } \}).$
        \item $\Delta_0=\cl_{\barM_g}(\{ [C] \in \barM_g \mid
                C \text{ :: union of two smooth curves of genus $i$ and $g-i$, meeting at $1$ pt } \})$
                for $i=1,\dots,\lfloor g/2\rfloor.$
    \end{itemize}
    \begin{Remark}
        命題(\ref{prop:finauto})から，
        ``union of two smooth curves of genus $0$ and $g$, meeting at $1$ pt"は
        stable curveではない．
        なので$\Delta_0$はsmooth rational irreducible componentを持たず，
        nodeをただひとつ持つ曲線に対応する点の集合の閉包として定義されている．
    \end{Remark}

    $\Delta_0,\dots,\Delta_{\lfloor g/2 \rfloor}$はirreducibleである．
    これは以下のように証明する．
    まず$\Delta_0$を考える．
    $C$ :: irreducible curve with $1$ nodeとする．
    これのnormalizationを$\tilde{C}$とすると，$C$のnodeは$\tilde{C}$の$2$点に対応する．
    そこで$\tilde{C}$とこの$2$点を組にして$\M_{g-1,2}$の点とする．
    こうして$\phi_0: \M_{g-1, 2} \to \Delta_0$が得られる．
    $\Delta_i \ (i>0)$の場合，
    $C$のnormalizationはgenus $i$, genus $g-i$のcomponentからなる．
    交点に対応する点をそれぞれ一つずつ持つから，
    これをdistinguished pointとして
    $\phi_i: \M_{i, 1} \times_k \M_{g-i, 1} \to \Delta_i$が得られる．
    こうして得られる$\phi_0,\dots,\phi_{\lfloor g/2 \rfloor}$は連続である(FACT)．
    
    $\barM_{g,n}$はirreducibleである(Thm2.15)．
    したがってその開集合$\M_{g,n}$もirreducibleである（$\Delta$ :: closedより）．
    $\M_{g,n}$は代数閉体上のscheme（実際にはvariety, Thm2.15）なので，
    これらのfiber productもirreducible．
    連続写像で写す操作と閉包をとる操作でirreducibilityが保たれるので，
    $\Delta_i=\cl(\im \phi_i) \ (i=0,\dots,\lfloor g/2 \rfloor)$はirreducibleである．

\section{(Semi-)Stable Reduction.}
    これは\cite{HaMo} 3.Cで詳しく扱う．
    個人的な意見で有るが，
    moduli問題においてstable curveの最も重要な特徴は，
    次の定理が成立することである．

\begin{Thm}[Deligne--Mumford Stable Reduction \cite{IrrOfMg}]
    $B$ :: smooth curve, $0 \in B$ :: closed point, $B^*:=B-\{0\}$とする．
    さらに$X \to B^*$ :: flat family of stable (resp.semi-stable) curves of arithmetic genus $g \geq 2$
    とする.
    この時，branched cover which totally ramified over $0$ :: $B' \to B$が存在し，
    $X \times_{B^*} B'$をstable family :: $X' \to B'$へ拡張することが出来る．
    この拡張で得られる$X'_{0}$は$B' \to B$と$X \times B'$の拡張に依らず，
    同型を除いて一意である．
\end{Thm}
    参考文献として他に\cite{TourStableRed}を挙げる．

\section{ Genus Formula }
    \begin{Prop}
        $C$ :: connected nordal curve of genus $g$とし，以下のように置く．
        \begin{itemize}
            \item $P_1,\dots,P_{\delta} \in C$ :: nodes of $C$,
            \item $C_1,\dots,C_{\nu}$ :: irreducible components of $C$,
            \item $g_i$ :: genus of $C_i$ for $i=1,\dots,\nu$.
        \end{itemize}
        この時，以下の等式が成立する．
        \[ g=\sum_{i=1}^{\nu} g_i-\nu+\delta+1=\sum_{i=1}^{\nu}(g_i-1)+\delta+1. \]
    \end{Prop}
    \begin{proof}
        $C, C_1,\dots, C_{\nu}$のnormalizationを
        それぞれ$\tilde{C}, \tilde{C}_1,\dots,\tilde{C}_i$とする．
        このとき$\shO_{\tilde{C}}=\sum_i \shO_{\tilde{C}_i}$.
        また，$\pi: \tilde{C} \to C$を自然な射影とする．
        $\pi$の定義から，
        $\pi^{\#}: \shO_{C} \to \pi_* \shO_{\tilde{C}}$は単射かつfinite
        \footnote
        {
            $C$のaffine open subset毎に包含写像から
            誘導される射$\Spec \tilde{A} \to \Spec A$が存在するので，
            $\pi$はこれらの射の張り合わせとして定義されている．
            finite morphismであることはfiniteness of integral closureから来る．
            ref. \cite{HarAG} Ex II.3.8.
        }．
        よって次のSESが存在する．
        \[\xymatrix{
                0 \ar[r]& \shO_{C} \ar[r]^-{\pi^{\#}}& \pi_* \shO_{\tilde{C}} \ar[r]&
                (\pi_* \shO_{\tilde{C}})/\shO_{C} \ar[r]& 0.
        }\]

        点$P$での$\C$のskyscraper sheafを$\C_P$と書くことにする．
        $(\pi_* \shO_{\tilde{C}})/\shO_{C} \iso \prod_{i=1}^{\delta} \C_{P_i}$
        を認めると，以下のLESが得られる．
        \[\xymatrix{
            0 \ar[r] & H^0(\shO_{C}) \ar[r]& H^0(\pi_* \shO_{\tilde{C}}) \ar[r]& H^0(\sum \C_{P_i}) \\
            {}\ar[r] & H^1(\shO_{C}) \ar[r]& H^1(\pi_* \shO_{\tilde{C}}) \ar[r]& H^1(\sum \C_{P_i}) \ar[r]& 0.
        }\]
        $H^j(C, \shF)$は$H^j(\shF)$と略した．
        $\dim_{\C}$がadditive functionであることから，
        次が得られる．
        \[
            h^0(\shO_{C})+h^0(\sum \C_{P_i})+h^1(\pi_* \shO_{\tilde{C}})
            =h^0(\pi_* \shO_{\tilde{C}})+h^1(\shO_{C})+h^1(\sum \C_{P_i})
        \]
        $\pi$ :: finite morphismであるから，
        \cite{HarAG} Ex III.4.1より$H^i(C, \pi_*\shO_{\tilde{C}}) \iso H^i(\tilde{C}, \shO_{\tilde{C}})$．
        $\tilde{C}$のconnected componentは$C$のirreducible componentと
        birational equivalentであるから，
        $h^0(\shO_{\tilde{C}})=\nu$.
        まとめて次のように成る．
        \begin{align*}
            h^0(\shO_{C})+h^0(\prod \C_{P_i})+h^1(\pi_* \shO_{\tilde{C}})
            =&h^0(\pi_* \shO_{\tilde{C}})+h^1(\shO_{C})+h^1(\prod \C_{P_i}) \\
            h^0(\shO_{C})+\prod h^0(\C_{P_i})+h^1(\shO_{\tilde{C}})
            =&h^0(\shO_{\tilde{C}})+h^1(\shO_{C})+h^1(\prod \C_{P_i}) \\
            1+\delta+\sum g_i
            =&\nu+g+0
        \end{align*}
        $X, Y$ :: disjoint schemesならば
        $H^i(X \sqcup Y) \iso H^i(X) \oplus H^i(Y)$であることに注意．

        最後に
        $(\pi_* \shO_{\tilde{C}})/\shO_{C} \iso \prod_{i=1}^{\delta} \C_{P_i}$
        を示す．
        各点$P \in C$における$(\pi_* \shO_{\tilde{C}})/\shO_{C}$のstalkを見る．
        私のノート Hartshorne\_AG\_Ch2/section6\_ex.pdf
        \footnote{\url{ https://github.com/ShitijyouA/MathNotes/blob/master/Hartshorne_AG_Ch2/section6_ex.pdf }}
        にあるEx6.9(a)の解答から，
        stalkは$\tilde{\shO}_{C, P}/\shO_{C, P}$．
        よって$\Supp (\pi_* \shO_{\tilde{C}})/\shO_{C}=\Sing C$であり，
        これは曲線の閉集合なので有限集合．
        したがって
        \footnote
        {
            射を$\sect{U}{s} \mapsto (s_x)_{x \in U}$で作り，
            これのstalkがisomorphismであることから
            同型を示す(\cite{HarAG} PropII.1.1)．
        }
        \[
            (\pi_* \shO_{\tilde{C}})/\shO_{C}
            \iso
            \prod_{i=1}^{\delta} \tilde{\shO}_{C, P_i}/\shO_{C, P_i}.
        \]
        $\dim_{\C} (\tilde{\shO}_{P_i}/\shO_{P_i})$は
        analytic isomorphicについての不変量だから
        (TODO, cf. \cite{HarAG} Ex IV.1.8c, \url{https://stacks.math.columbia.edu/tag/02M1})，
        $\Spec \C[x,y]/(xy)$の原点について計算することで，
        $\dim_{\C} (\tilde{\shO}_{P_i}/\shO_{P_i})=1$を得る．
        よって所望の同型を得る．
    \end{proof}

\section{ Dualizing Sheaf }
    \subsection{Definitions}    
    \begin{Def}[Dualizing Sheaf of Curve, implicit]
        $X$ :: proper scheme of pure dimension $n$ over a field $k$とする．
        $\dualsh_X$ :: dualizing sheaf for $X$とは，
        以下の条件を満たす
        trace morphism :: $t_X: H^n(X, \dualsh_X) \to k$を備える
        sheaf on $X$のことである:
        任意のcoherent sheaf $\shF$について，以下は同型である．
        \begin{defmap}
            (t_X \circ):& \Hom_{\shO_X}(F, \dualsh_X)& \to& H^n(X, \shF) \\
            {}& \phi& \mapsto& t_X \circ \phi
        \end{defmap}
    \end{Def}

    \begin{Remark}
        定義の仕方から，$\dualsh_X$は次のようにも定義できる．
        すなわち，$\dualsh_X$は$\shF \mapsto H^n(X, \shF)^*$という関手の
        representationである．
    \end{Remark}

    \begin{Def}[Dualizing Sheaf of Curve, explicit, \cite{SerreSAC}]
        $C$ :: stable curve (over $\C$),
        $L$ :: function field of $C$,
        $\dermod_{K/\C}$ :: the module of differentioals of $C$ over $\C$.
        $v: \tilde{C} \to C$をnormalizationとする．
        
        $\dualsh_C$とは，
        $C$の開集合$U$に対して次のように定められるsheaf on $C$である．
        \[
            \dualsh_C(U)=
            \left\{
                \omega \in \dermod_{L/\C}
                \ \middle|\ 
                \Forall{x \in U} \Forall{f \in \shO_{C, x}} \res_x(v^{\#}_x(f) \cdot \omega)=0.
            \right\}
        \]
        ここで$\res_x=\sum_{y \in v^{-1}(x)} \res_y$とおいた．
        $C$ :: at-worst-nordal curveであるから，
        $v^{-1}(P)$は高々$2$点集合である．
    \end{Def}
    \begin{Remark}
        \cite{HaMo} 3.Aにおいては$\dualsh_C(U)$は以下のように定義されている．
        \[
            \dualsh_C(U)=
            \left\{
                \eta \in (v_*\dersh_{C/\C})
                \ \middle|\ 
                \Forall{x \in U \cap \Sing C} \res_x(\eta)=0.
            \right\}
        \]
        $\res_x$の定義は上と同じである．

        $\dualsh_X$の明示的な定義は次を参照しても良い:
        Matthew Morrow
        ``An explicit approach to residues on and dualizing sheaves of arithmetic surfaces"
        \footnote{\url{ https://arxiv.org/abs/0911.0590v2 }}
    \end{Remark}

    \begin{Def}[Divisor of Singular Curve, and $\deg D, l(D)$] \label{def:DivOfSingCurve}
        $C$ :: projective (abstruct) variety of dimention $1$
        over an algebraically closed field $\C$とする．
        $C$のregular point全体を$\Reg C$とする．
        （$\Reg C$はCor II.8.16 (or Thm I.5.3)からopen dense subset.）

        $C$のdivisorとは，$\Reg C$のWeil divisor
        \[ \sum_{i=1}^{r} n_i P_i \qquad (n_i \in \Z, P_i \in \Reg C) \]
        のこと．
        divisor :: $D=\sum_{i=1}^{r} n_i P_i$に対して，
        $\deg D, l(D)$は通常のdivisorと同様に定める．
        \[ \deg D=\sum_i n_i, \qquad l(D)=h^0(C, \shL(D)). \]
        $\dim_{\C} H^i(-,-)$は$h^i(-,-)$と略した．
    \end{Def}

    \begin{Def}[Canonical Divisor of Singular Curves]
        $C$を定義(\ref{def:DivOfSingCurve})と同様にする．
        この時\cite{HarAG} III.7.11より$\dualsh_C$ :: invertible sheafなので，
        $\dualsh_C$に対応するdivisor（参考: \cite{HarAG} II.6）が存在する．
        これを$K$ (or $K_C$)と書き，$C$のcanonical divisorと呼ぶ．
    \end{Def}

    \subsection{Key Propositions}
    \begin{Thm} \label{thm:Hi_iso_Hn-i}
        $X$ :: projective Cohen-Macaulay (in paticular, locally complete intersection)
        scheme of equidimention $n$
        over an algebraically closed field $k$とする．
        この時，lcally free sheaf :: $\shF$について次が成立する．
        \[ H^i(X, \shF) \iso H^{n-i}(X, \shF \sidecheck \otimes_{\shO_X} \dualsh_X). \]
    \end{Thm}

    \begin{Thm}[Riemann-Roch for Singular Curves, \cite{HarAG} Ex IV.1.9] \label{thm:RRforSingCurve}
        $C$ :: integral projective scheme of dimension $1$
        over a algebraically closed field $\C$
        (特にirreducible stable curve)とする．
        $C$のdivisor :: $C$について，次の等式が成立する．
        \[ l(D)-l(K-D)=\deg D+1-g. \]
        $g$は$C$のarithmetic genusである．
    \end{Thm}
    証明はしばらく後で示す．

    \begin{Lemma}
        $C$ :: stable curve （より一般にnordal curve）とする．
        この時$C$はlocally complete intersectionである．
    \end{Lemma}
    \begin{proof}
        locally complete intersectionであるとは，
        各点$P \in C$について$\shO_{C, P}$がcomplete intersection ringであること．
        $P$ :: smooth pointならば$\shO_{C, P}$ :: regular local ringであり，
        したがってcomplete intersection ringなので，
        $P$はnodeとする．

        今，$C$ :: finite type over $\C$であるから，
        $\shO_{C, P}$はnoetherian local ring.
        なのでこの条件は完備化$(\shO_{C, P})\sidehat$が
        complete intersection ringであることと同値
        (\cite{Mat} Thm21.2 (i))．
        $P$はnodeとしたから，
        \[ (\shO_{C, P})\sidehat \iso \C[[x,y]]/(xy). \]
        $xy$は$k[[x,y]]$-regular (i.e. not zero-divisor in $k[[x,y]]$)であるから，
        右辺はcomplete intersection ring (\cite{Mat} Thm21.2 (ii))．
        よって主張が示された．
    \end{proof}

    \begin{Prop}
        $C$ :: stable curve, $\dualsh_C$ :: dual sheaf of $C$とする．
        \begin{enumerate}[label=(\roman*), leftmargin=*]
            \item $\dualsh_C$ :: invertible sheaf.
            \item $h^0(C, \dualsh_C)=g$.
            \item $\deg \dualsh_C=2g-2$.
            \item For $g \geq 2, n \geq 2$, $H^0(C, (\dualsh_C)^{\otimes n})=(2n-1)(g-1)$.
            \item For $g \geq 2, n \geq 3$, $(\dualsh_C)^{\otimes n}$ :: very ample.
        \end{enumerate}
    \end{Prop}
    \begin{proof}
        \begin{enumerate}[label=(\roman*), leftmargin=*]
        \item
        canonical divisorの定義で触れた．
        \cite{HarAG} III.7.11に証明がある．

        \item
        The Serre duality (\ref{thm:Hi_iso_Hn-i})から
        $h^0(C, \dualsh_C)=h^1(C, \shO_C)=g$.

        \item
        (\ref{thm:RRforSingCurve})において$D=K$とし，
        $l(0)=1, l(K)=h^0(C, \dualsh_C)=g$を用いれば良い．

        \item
        $D=nK$とすると，
        これはnon-special (ref. \cite{HarAG} Example IV.1.3.4)，
        すなわち$l(K-D)=0$．
        (\ref{thm:RRforSingCurve})においてこのことと$\deg (nK)=n \deg K$を用いれば良い．
        また，(\ref{thm:Hi_iso_Hn-i})より
        \[ H^1(C, (\dualsh_C)^{\otimes n}) \iso H^0(C, (\dualsh_C)^{\otimes 1-n}) \]
        なので，$n \geq 2$の時$H^1(C, (\dualsh_C)^{\otimes n})=0$も成立する．

        \item
        \cite{HarAG} Cor IV.3.2
        \footnote
        {
            定理はnonsingular curveを仮定しているが，
            証明では\cite{HarAG} II.7の結果と(\ref{thm:RRforSingCurve})の等式しか使っていない．
            なのでこの仮定はstable curveに弱められる．
        }
        から，$nK$ :: very ampleは$\deg nK \geq 2g+1$と同値．
        $g \geq 2, n \geq 3$なので成立する．
        \end{enumerate}
    \end{proof}

    \subsection{Proof of Thm (\ref{thm:RRforSingCurve})}
    \begin{proof}
    \end{proof}

\section{ Relative Dualizing Sheaf }
    \subsection{ Definitions }
    \begin{Def}[Relative Dualizing Sheaf of Curve, implicit]
        $f: X \to S$ :: morphism of proper schemes of pure dimension $n$ over a field $k$とする．
        relative dualizing sheaf of $f$ :: $\dualsh_{X/S}$とは，
        次の関手の表現対象のこと．
        \begin{defmap}
            {}& \text{(Coh Sheaves on $X$)}& \to& \text{($\shO_X$-Mod)} \\
            {}& \shF& \mapsto& (R^n f_*(\shF))^*
        \end{defmap}
    \end{Def}

    \begin{Def}[Relative Dualizing Sheaf of Curve, explicit]
        $C \to B$ :: flat family of stable curvesとする．
        relative dualizing sheaf of $\pi$ :: $\dualsh_{C/B}$とは，
        $C$の開集合$U$を次のように写すsheaf on $C$．
        \[
            \dualsh_C(U)=
            \left\{
                \eta \in (v_*\dersh_{C/B})
                \ \middle|\ 
                \Forall{x \in U \cap \Sing C} \res_x(\eta)=0.
            \right\}
        \]
        ただし$v: \tilde{C} \to C$はnormalization.
    \end{Def}

    \subsection{Key Propositions}
    extend
    base exchange

\bibliographystyle{jplain}
\bibliography{reference}
\end{document}
